
# Objective
* To customize time slots options according to history

# Method
* Calculate and rank available time slots with reference to a specified date and time

# Tools
* MSSQL Management Studio

# Detailed calculations
1.	Obtain the start time and day of week of the specified date and time
2.	Obtain the earliest available date
3.	Rank possible time slot options
4.	Generate the available time slots
5.	List required number of the available time slots

# Calculation result sample
## Input
* Last start date:            		2017-1-1 19:00:00
* The earliest available date:          2017-1-15
* Time slot separation length:        60 minutes
* Search period:                                1 month
* Time slot search iteration:           30 
* Time slot duration:		90

## Output

 
| display_order |	search_datetime_start	| search_datetime_end |
| ------------- | --------------------- | ------------------- |
| 	1	 | 	15/1/2017 19:00	 | 	15/1/2017 20:30	 |
| 	2	 | 	22/1/2017 19:00	 | 	22/1/2017 20:30	 |
| 	3	 | 	29/1/2017 19:00	 | 	29/1/2017 20:30	 |
| 	4	 | 	5/2/2017 19:00	 | 	5/2/2017 20:30	 |
| 	5	 | 	12/2/2017 19:00	 | 	12/2/2017 20:30	 |
| 	6	 | 	15/1/2017 20:00	 | 	15/1/2017 21:30	 |
| 	7	 | 	22/1/2017 20:00	 | 	22/1/2017 21:30	 |
| 	8	 | 	29/1/2017 20:00	 | 	29/1/2017 21:30	 |
| 	9	 | 	5/2/2017 20:00	 | 	5/2/2017 21:30	 |
| 	10	 | 	12/2/2017 20:00	 | 	12/2/2017 21:30	 |
| 	11	 | 	15/1/2017 18:00	 | 	15/1/2017 19:30	 |
| 	12	 | 	22/1/2017 18:00	 | 	22/1/2017 19:30	 |
| 	13	 | 	29/1/2017 18:00	 | 	29/1/2017 19:30	 |
| 	14	 | 	5/2/2017 18:00	 | 	5/2/2017 19:30	 |
| 	15	 | 	12/2/2017 18:00	 | 	12/2/2017 19:30	 |
| 	16	 | 	15/1/2017 21:00	 | 	15/1/2017 22:30	 |
| 	17	 | 	22/1/2017 21:00	 | 	22/1/2017 22:30	 |
| 	18	 | 	29/1/2017 21:00	 | 	29/1/2017 22:30	 |
| 	19	 | 	5/2/2017 21:00	 | 	5/2/2017 22:30	 |
| 	20	 | 	12/2/2017 21:00	 | 	12/2/2017 22:30	 |
| 	21	 | 	15/1/2017 17:00	 | 	15/1/2017 18:30	 |
| 	22	 | 	22/1/2017 17:00	 | 	22/1/2017 18:30	 |
| 	23	 | 	29/1/2017 17:00	 | 	29/1/2017 18:30	 |
| 	24	 | 	5/2/2017 17:00	 | 	5/2/2017 18:30	 |
| 	25	 | 	12/2/2017 17:00	 | 	12/2/2017 18:30	 |
| 	26	 | 	15/1/2017 22:00	 | 	15/1/2017 23:30	 |
| 	27	 | 	22/1/2017 22:00	 | 	22/1/2017 23:30	 |
| 	28	 | 	29/1/2017 22:00	 | 	29/1/2017 23:30	 |
| 	29	 | 	5/2/2017 22:00	 | 	5/2/2017 23:30	 |
| 	30	 | 	12/2/2017 22:00	 | 	12/2/2017 23:30	 |
| 	31	 | 	15/1/2017 16:00	 | 	15/1/2017 17:30	 |
| 	32	 | 	22/1/2017 16:00	 | 	22/1/2017 17:30	 |
| 	33	 | 	29/1/2017 16:00	 | 	29/1/2017 17:30	 |
| 	34	 | 	5/2/2017 16:00	 | 	5/2/2017 17:30	 |
| 	35	 | 	12/2/2017 16:00	 | 	12/2/2017 17:30	 |
| 	36	 | 	15/1/2017 23:00	 | 	16/1/2017 0:30	 |
| 	37	 | 	22/1/2017 23:00	 | 	23/1/2017 0:30	 |
| 	38	 | 	29/1/2017 23:00	 | 	30/1/2017 0:30	 |
| 	39	 | 	5/2/2017 23:00	 | 	6/2/2017 0:30	 |
| 	40	 | 	12/2/2017 23:00	 | 	13/2/2017 0:30	 |
| 	41	 | 	15/1/2017 15:00	 | 	15/1/2017 16:30	 |
| 	42	 | 	22/1/2017 15:00	 | 	22/1/2017 16:30	 |
| 	43	 | 	29/1/2017 15:00	 | 	29/1/2017 16:30	 |
| 	44	 | 	5/2/2017 15:00	 | 	5/2/2017 16:30	 |
| 	45	 | 	12/2/2017 15:00	 | 	12/2/2017 16:30	 |
| 	46	 | 	15/1/2017 14:00	 | 	15/1/2017 15:30	 |
| 	47	 | 	22/1/2017 14:00	 | 	22/1/2017 15:30	 |
| 	48	 | 	29/1/2017 14:00	 | 	29/1/2017 15:30	 |
| 	49	 | 	5/2/2017 14:00	 | 	5/2/2017 15:30	 |
| 	50	 | 	12/2/2017 14:00	 | 	12/2/2017 15:30	 |
| 	51	 | 	15/1/2017 13:00	 | 	15/1/2017 14:30	 |
| 	52	 | 	22/1/2017 13:00	 | 	22/1/2017 14:30	 |
| 	53	 | 	29/1/2017 13:00	 | 	29/1/2017 14:30	 |
| 	54	 | 	5/2/2017 13:00	 | 	5/2/2017 14:30	 |
| 	55	 | 	12/2/2017 13:00	 | 	12/2/2017 14:30	 |
| 	56	 | 	15/1/2017 12:00	 | 	15/1/2017 13:30	 |
| 	57	 | 	22/1/2017 12:00	 | 	22/1/2017 13:30	 |
| 	58	 | 	29/1/2017 12:00	 | 	29/1/2017 13:30	 |
| 	59	 | 	5/2/2017 12:00	 | 	5/2/2017 13:30	 |
| 	60	 | 	12/2/2017 12:00	 | 	12/2/2017 13:30	 |
| 	61	 | 	15/1/2017 11:00	 | 	15/1/2017 12:30	 |
| 	62	 | 	22/1/2017 11:00	 | 	22/1/2017 12:30	 |
| 	63	 | 	29/1/2017 11:00	 | 	29/1/2017 12:30	 |
| 	64	 | 	5/2/2017 11:00	 | 	5/2/2017 12:30	 |
| 	65	 | 	12/2/2017 11:00	 | 	12/2/2017 12:30	 |
| 	66	 | 	15/1/2017 10:00	 | 	15/1/2017 11:30	 |
| 	67	 | 	22/1/2017 10:00	 | 	22/1/2017 11:30	 |
| 	68	 | 	29/1/2017 10:00	 | 	29/1/2017 11:30	 |
| 	69	 | 	5/2/2017 10:00	 | 	5/2/2017 11:30	 |
| 	70	 | 	12/2/2017 10:00	 | 	12/2/2017 11:30	 |
| 	71	 | 	15/1/2017 9:00	 | 	15/1/2017 10:30	 |
| 	72	 | 	22/1/2017 9:00	 | 	22/1/2017 10:30	 |
| 	73	 | 	29/1/2017 9:00	 | 	29/1/2017 10:30	 |
| 	74	 | 	5/2/2017 9:00	 | 	5/2/2017 10:30	 |
| 	75	 | 	12/2/2017 9:00	 | 	12/2/2017 10:30	 |
| 	76	 | 	15/1/2017 8:00	 | 	15/1/2017 9:30	 |
| 	77	 | 	22/1/2017 8:00	 | 	22/1/2017 9:30	 |
| 	78	 | 	29/1/2017 8:00	 | 	29/1/2017 9:30	 |
| 	79	 | 	5/2/2017 8:00	 | 	5/2/2017 9:30	 |
| 	80	 | 	12/2/2017 8:00	 | 	12/2/2017 9:30	 |
| 	81	 | 	15/1/2017 7:00	 | 	15/1/2017 8:30	 |
| 	82	 | 	22/1/2017 7:00	 | 	22/1/2017 8:30	 |
| 	83	 | 	29/1/2017 7:00	 | 	29/1/2017 8:30	 |
| 	84	 | 	5/2/2017 7:00	 | 	5/2/2017 8:30	 |
| 	85	 | 	12/2/2017 7:00	 | 	12/2/2017 8:30	 |
| 	86	 | 	15/1/2017 6:00	 | 	15/1/2017 7:30	 |
| 	87	 | 	22/1/2017 6:00	 | 	22/1/2017 7:30	 |
| 	88	 | 	29/1/2017 6:00	 | 	29/1/2017 7:30	 |
| 	89	 | 	5/2/2017 6:00	 | 	5/2/2017 7:30	 |
| 	90	 | 	12/2/2017 6:00	 | 	12/2/2017 7:30	 |
| 	91	 | 	15/1/2017 5:00	 | 	15/1/2017 6:30	 |
| 	92	 | 	22/1/2017 5:00	 | 	22/1/2017 6:30	 |
| 	93	 | 	29/1/2017 5:00	 | 	29/1/2017 6:30	 |
| 	94	 | 	5/2/2017 5:00	 | 	5/2/2017 6:30	 |
| 	95	 | 	12/2/2017 5:00	 | 	12/2/2017 6:30	 |
| 	96	 | 	15/1/2017 4:00	 | 	15/1/2017 5:30	 |
| 	97	 | 	22/1/2017 4:00	 | 	22/1/2017 5:30	 |
| 	98	 | 	29/1/2017 4:00	 | 	29/1/2017 5:30	 |
| 	99	 | 	5/2/2017 4:00	 | 	5/2/2017 5:30	 |
| 	100	 | 	12/2/2017 4:00	 | 	12/2/2017 5:30	 |
| 	101	 | 	15/1/2017 3:00	 | 	15/1/2017 4:30	 |
| 	102	 | 	22/1/2017 3:00	 | 	22/1/2017 4:30	 |
| 	103	 | 	29/1/2017 3:00	 | 	29/1/2017 4:30	 |
| 	104	 | 	5/2/2017 3:00	 | 	5/2/2017 4:30	 |
| 	105	 | 	12/2/2017 3:00	 | 	12/2/2017 4:30	 |
| 	106	 | 	15/1/2017 2:00	 | 	15/1/2017 3:30	 |
| 	107	 | 	22/1/2017 2:00	 | 	22/1/2017 3:30	 |
| 	108	 | 	29/1/2017 2:00	 | 	29/1/2017 3:30	 |
| 	109	 | 	5/2/2017 2:00	 | 	5/2/2017 3:30	 |
| 	110	 | 	12/2/2017 2:00	 | 	12/2/2017 3:30	 |
| 	111	 | 	15/1/2017 1:00	 | 	15/1/2017 2:30	 |
| 	112	 | 	22/1/2017 1:00	 | 	22/1/2017 2:30	 |
| 	113	 | 	29/1/2017 1:00	 | 	29/1/2017 2:30	 |
| 	114	 | 	5/2/2017 1:00	 | 	5/2/2017 2:30	 |
| 	115	 | 	12/2/2017 1:00	 | 	12/2/2017 2:30	 |
| 	116	 | 	15/1/2017 0:00	 | 	15/1/2017 1:30	 |
| 	117	 | 	22/1/2017 0:00	 | 	22/1/2017 1:30	 |
| 	118	 | 	29/1/2017 0:00	 | 	29/1/2017 1:30	 |
| 	119	 | 	5/2/2017 0:00	 | 	5/2/2017 1:30	 |
| 	120	 | 	12/2/2017 0:00	 | 	12/2/2017 1:30	 |

